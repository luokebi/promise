function Promise(e){function n(){var e=Array.prototype.slice.call(arguments),n=r._thens.shift();if(n){var t=n.apply(null,e);if(t instanceof Promise)t._thens=r._thens;else{var o=new Promise(function(e){setTimeout(function(){e(t)})});o._thens=r._thens}}}var r=this;this._thens=[],e.call(null,n)}Promise.prototype.then=function(e){return this._thens.push(e),this},Promise.resolve=function(){var e=Array.prototype.slice.call(arguments),n=new Promise(function(n){n.apply(null,e)});return n},Promise.all=function(e){for(var n=e.length,r=Promise.deferred(),t=[],o=0;n>o;o++)!function(o){var i=e[o];i.then(function(e){t[o]=e,t.length===n&&r.resolve(t)})}(o);return r.promise},Promise.any=function(e){for(var n=e.length,r=Promise.deferred(),t=[],o=0;n>o;o++)!function(n){var o=e[n];o.then(function(e){t[n]=e,t.length>0&&r.resolve(e)})}(o);return r.promise},Promise.queue=function(e){for(var n=e[0](),r=1,t=e.length;t>r;r++)!function(r){n.then(e[r])}(r);return n},Promise.deferred=function(){var e={};return e.promise=new Promise(function(n){e.resolve=n}),e};